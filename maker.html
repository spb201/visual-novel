<!DOCTYPE html>
<html>
	<head>
		<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
		<script src="https://cdn.firebase.com/js/client/2.2.1/firebase.js"></script>
		<script src="https://cdn.firebase.com/libs/angularfire/1.0.0/angularfire.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
		<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.2/underscore-min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/alertify.js/0.3.0/alertify.min.js"></script>
		<script src="http://cytoscape.github.io/cytoscape.js/api/cytoscape.js-latest/cytoscape.min.js"></script>
		<script src="js/controller.js"></script>
		<script src="js/maker.js"></script>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
		<link rel="stylesheet" href="css/maker.css">
		<link rel="stylesheet" href="css/alertify.css">
		<link rel="stylesheet" href="css/common.css">
		<title>v0.0.0.0.0.0.4</title>
	</head>
	<body ng-app="ngApp">
		<div ng-controller="makerController" id="maker">
			<a href="index.html" id="to-index" class="btn btn-default">Return to index</a>
			<nav class="navbar navbar-default  navbar-fixed-top">
				<div class="container-fluid">
					<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
						<div class="navbar-form form-inline">
							<div class="btn-group" role="group">
								<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
									Public quests <span class="caret"></span>
								</button>
								<ul class="dropdown-menu dropdown-size" role="menu">
									<li ng-repeat="quest in quests">
										<a href="#" ng-click="saved(quest.$value)">{{ getValue(quest.$value, 'title') || 'untitled' }}</a>
									</li>
								</ul>
							</div>
							<div class="btn-group" role="group" ng-show="isAuthorized && myQuests.length > 0">
								<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
									My quests <span class="caret"></span>
								</button>
								<ul class="dropdown-menu dropdown-size" role="menu">
									<li ng-repeat="quest in myQuests">
										<a href="#" ng-click="saved(quest.$value)">{{ getValue(quest.$value, 'title') || 'untitled' }}</a>
									</li>
								</ul>
							</div>
							<div class="input-group">
								<span class="input-group-addon">Title</span>
								<input ng-model="_q.title" type="text" class="form-control">
							</div>
							<div class="input-group">
								<span class="input-group-addon">Description</span>
								<input ng-model="_q.descr" type="text" class="form-control">
							</div>
							<div class="input-group">
								<span class="input-group-addon">Image</span>
								<input ng-model="_q.image" type="text" class="form-control" placeholder="URL">
							</div>
							<button ng-click="add()" class="btn btn-default">Add new node</button>
							<button ng-click="saveToServer()" class="btn btn-default">Save</button>
							<button ng-click="publish()" class="btn btn-default">Publish</button>
						</div>
					</div>
				</div>
			</nav>
			<p ng-hide="_q.nodes" id="warning">Can't take quest neither from session storage nor from input string</p>
			<div id="nodecontainer">
				<div class="nodes well well-sm drag-node" draggable ng-repeat="node in _q.nodes">
					<span class="glyphicon glyphicon-remove xmark" ng-click="remove(node.id)"></span>
					<h4>Node {{ node.id }}</h4>
					<div class="input-group">
						<span class="input-group-addon">Text</span>
						<input ng-model="node.text" class="form-control">
					</div>
					<div class="row" ng-show="node.ways_ids">
						<span class="col-md-3">Way id</span>
						<span class="col-md-9">Way text</span>
					</div>
					<div class="row" ng-repeat="i in  _.range(node.ways_ids.length)">
						<div class="col-md-3">
							<select class="form-control" ng-model="node.ways_ids[i]">
								<option ng-repeat="node in _q.nodes">{{ node.id }}</option>
							</select>
						</div>
						<div class="col-md-9">
							<input ng-model="node.ways[i]" class="form-control">
						</div>
					</div>
					<a href="#" class="btn btn-default" ng-click="addWay(node.id)">Add new way</a>
					<div class="form-inline">
						<label><input type="checkbox" ng-model="node.image"> Image</label>
						<input ng-model="node.imagesrc" class="form-control" type="text" ng-show="node.image">
						<img ng-src="{{ node.imagesrc }}" ng-show="node.image" style="max-width: 100px; max-height: 100px;"></img>
					</div>
					<div class="checkbox">
						<label>
							<input ng-model="node.final" type="checkbox"> Final
						</label>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
